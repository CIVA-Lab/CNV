# Cornea Detection and CNV Grading
This work proposes a robust automated approach to grade Cornea NeoVascularization (CNV) disease based on in-growth vessels. The figure describes the whole automated process. The intuition behind our work is to predict the grade of the corresponding cornea using vessel specific features and a regression network. The first part of our algorithm is to separate the cornea region from other parts of the mice image. While the second part is to learn a regression network how to predict a class or a grade of the disease. For the first part, we utilize Mask R-CNN, the state of the art deep learning network in biomedical segmentation, to detect the cornea region. A set of mice images have been selected and annotated to train the Mask R-CNN. As a result, a binary mask is produced, the white region represents the cornea and the black region represents the background that cover all other parts such as eyelid and lashes. Eliminating cornea's outside region, decreases the errors that can affected by texture and color of those parts and produces more robust classifier. However, mask R-CNN binary mask result is not always a proper circle. For this reason, we fitted a circle on our binary mask result to produce an optimal circular mask. The raw image is masked out using the circular binary mask to produce the extracted cornea region. A set of vessel specific features have been generated based on multiscale Hessian eigenvalues, intensity, oriented second derivatives, and multiscale line detector responses along with a random forest classifier. Random forest algorithm is a supervised statistical classifier that needs to be trained first using a set of cornea images with corresponding grades. The images are divided to 5 grades: No CNV Naive (0), No CNV (1), Mild CNV (2), Moderate CNV (3), and Severe CNV (4). We trained a regression network to learn random forest how to grade images based on the generated features. As a result, we utilize the trained random forest regression model to produce the grades of our testing data. The testing data are a set of images that have been kept aside to assess the quality of our automated learning.
